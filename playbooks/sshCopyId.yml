---

- name: Create user playbook
  hosts: all
  become: true
  vars_prompt:
    targetUser:
      prompt: "Enter the username of the target user: "
      private: false
    sskKeyInput:
      prompt: "Enter the contents of the .pub file you want to copy over: "
      private: false

  tasks:
  - name: create .ssh folder, if it does not exist
    ansible.builtin.file:
      path: /home/ansibleuser/.ssh
      state: directory
      owner: ansibleuser
      group: ansibleuser
      mode: '0700'

  - name: Copy ssh key
    ansible.builtin.lineinfile:
      path: /home/ansibleuser/.ssh/authorized_keys
      line: "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIDQlp2lxJZoL/0aTI4Zii6Osab+W72vqh1pDa9Coarta ansiblewizard@wizardstower"
      state: present
      owner: ansibleuser
      group: ansibleuser
      mode: '0600'
      backup: true
      create: true